<form id="listingForm" enctype="multipart/form-data">
    <input type="text" id="title" placeholder="Title" required>
    <textarea id="description" placeholder="Description (No phone numbers allowed)" required></textarea>
    <select id="category">
        <option value="Dogs">Dogs</option>
        <option value="Cats">Cats</option>
        <option value="Goat">Goat</option>
        <option value="Other">Other</option>
    </select>
    <input type="text" id="location" placeholder="Location" required>
    <input type="number" id="price" placeholder="Price" required>
    <input type="file" id="media" name="file" accept="image/*">
    <button type="submit">Post Listing</button>
</form>

<script>
document.getElementById("listingForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const formData = new FormData();
    formData.append("file", document.getElementById("media").files[0]); // Select first image
    formData.append("title", document.getElementById("title").value);
    formData.append("description", document.getElementById("description").value);
    formData.append("category", document.getElementById("category").value);
    formData.append("location", document.getElementById("location").value);
    formData.append("price", document.getElementById("price").value);

    // Upload image first
    const uploadResponse = await fetch("http://localhost:5000/upload", {
        method: "POST",
        body: formData
    });

    const uploadResult = await uploadResponse.json();
    console.log("Uploaded Image ID:", uploadResult.fileId);

    if (uploadResult.fileId) {
        alert("Listing posted successfully!");
    }
});
</script>
